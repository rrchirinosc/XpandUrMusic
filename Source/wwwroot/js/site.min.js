var Index=function(){function n(){var n=$("#artist-input").val(),i={artistName:n};$("#artists-display").off("click",".artist-container",t);$.ajax({type:"GET",url:"/Home/ArtistLookup",data:i,dataType:"json",cache:!1}).fail(function(){alert("artistLookup() failed")}).done(function(i){var r,u;if($("#artists-area").css("display","block"),$("#artists-display").empty(),i===undefined||i.length===0)$("#artists-display").append("<span>No Artists matching <b>{0}<\/b> found<\/span>".format(n));else{r='<div class="artist-container">    <img class="artist-image" src={0} alt="{1}" data-id={2}>   <span class="artist-name">{3}<\/span><\/div>';for(index in i)u=i[index].image===null?"./images/default_artist_image.jpg":i[index].image.url,$("#artists-display").append(r.format(u,i[index].name,i[index].id,i[index].name));$("#artists-display").on("click",".artist-container",t);$("#get-recommendations").removeAttr("disabled")}})}function t(){var n=$(this).find(":first");$(this).hasClass("artist-selected")===!0?$(this).removeClass("artist-selected"):$(this).addClass("artist-selected")}function i(){var n=$(this).find(":first");$(this).hasClass("genre-selected")===!0?$(this).removeClass("genre-selected"):$(this).addClass("genre-selected")}function r(){for(var r,u,t=[],i=$("#artists-display").children(".artist-selected"),n=0;n<i.length;n++)r=$(i[n]).find(":first"),u=r.attr("data-id"),t.push(u);return t}function u(){for(var r,t=[],i=$("#musical-genres").children(".genre-selected"),n=0;n<i.length;n++)r=$(i[n]).text(),t.push(r);return t}function f(){$("#musical-genres").off("click",".genre-box",i);$.ajax({type:"GET",url:"/Home/GetGenres",cache:!1}).fail(function(){alert("setGenres() failed")}).done(function(n){if($("#musical-genres").empty(),n===undefined||n.length===0)$("#musical-genres").append("<span>Failed to fetch genres<\/span>".format(artistName));else{for(index in n)$("#musical-genres").append('<span class="genre-box">{0}<\/span>'.format(n[index]));$("#musical-genres").on("click",".genre-box",i);$("#get-recommendations").removeAttr("disabled")}})}$("#artist-find").click(function(){n()});$("#artist-input").on("keydown",function(t){var i=$("#artist-input").val();t.which===13&&i!==""&&n()});$("#get-recommendations").click(function(){$("#artists").val(r());$("#genres").val(u());$("#show-recommendations").submit()});f()},Recommendations;$(document).ready(function(){new Index});Recommendations=function(){function n(){$(this).hasClass("decade-selected")===!0?$(this).removeClass("decade-selected"):$(this).addClass("decade-selected");t($(this).attr("data-year"),$(this).hasClass("decade-selected"))}function t(n,t){for(var u,f=parseInt(n),r=$("#albums-display").children(".album-container"),i=0;i<r.length;i++)if(u=parseInt($(r[i]).attr("data-year")),u>=f&&u<=f+9){t===!0?$(r[i]).show():$(r[i]).hide();continue}}function i(){for(var n,i=0,r=$("#albums-display").children(".album-container"),t=0;t<r.length;t++)(n=$(r[t]).attr("data-year"),n<1950)||(i|=n>=1950&&n<=1959?64:n>=1960&&n<=1969?32:n>=1970&&n<=1979?16:n>=1980&&n<=1989?8:n>=1990&&n<=1999?4:n>=2e3&&n<=2009?2:1);return i}function r(){for(var t=$("#album-filter-items").children(".decade-box"),n=0;n<t.length;n++)$(t[n]).unbind("click")}function u(){var r=i(),f,u,t;if(r!==0)for(f=$("#album-filter-items").children(".decade-box"),u=0;u<f.length;u++){if(t=$(f[u]).attr("data-year"),t>=1950&&t<=1959&&!(r&64))continue;else if(t>=1960&&t<=1969&&!(r&32))continue;else if(t>=1970&&t<=1979&&!(r&16))continue;else if(t>=1980&&t<=1989&&!(r&8))continue;else if(t>=1990&&t<=1999&&!(r&4))continue;else if(t>=2e3&&t<=2009&&!(r&2))continue;else if(!(r&1))continue;$(f[u]).addClass("decade-selected");$(f[u]).bind("click",n)}}$(".decade-box").click(function(){n()});r();u()};$(document).ready(function(){new Recommendations});